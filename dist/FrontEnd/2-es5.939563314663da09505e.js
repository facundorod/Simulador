function _createForOfIteratorHelper(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=_unsupportedIterableToArray(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a,i=!0,o=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return i=t.done,t},e:function(t){o=!0,a=t},f:function(){try{i||null==r.return||r.return()}finally{if(o)throw a}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _createSuper(t){return function(){var e,n=_getPrototypeOf(t);if(_isNativeReflectConstruct()){var r=_getPrototypeOf(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return _possibleConstructorReturn(this,e)}}function _possibleConstructorReturn(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{"FkO/":function(t,e,n){"use strict";function r(t,e,n,r,a,i){return{stroke:{curve:"smooth",width:2},markers:{size:0},xaxis:{type:"numeric",labels:{show:!1},axisTicks:{show:!1},axisBorder:{show:!0},max:e,min:n},chart:{id:"curves",type:i||"line",height:t?130:143,redrawOnParentResize:!0,redrawOnWindowResize:!0,zoom:{enabled:t},toolbar:{show:t}},fill:{type:"solid"},yaxis:{labels:{show:t},show:t,max:r,min:0},dataLabels:{enabled:!1},legend:{show:!1},grid:{show:!1},tooltip:{enabled:t}}}n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return a}));var a=function(){function t(e){_classCallCheck(this,t),this.chartOptions=e}return _createClass(t,[{key:"setChart",value:function(t,e){this.apexChartOptions={series:[{data:t,color:this.chartOptions.colorLine}],stroke:{curve:"smooth",width:2},markers:{size:0},xaxis:{type:"numeric",labels:{show:!1},axisTicks:{show:!1},max:this.chartOptions.maxX,min:this.chartOptions.minX,axisBorder:{show:!0}},chart:{id:"curves",animations:{enabled:!0,easing:"linear",animateGradually:{enabled:!0},dynamicAnimation:{enabled:!0}},redrawOnParentResize:!0,redrawOnWindowResize:!0,height:this.chartOptions.height,type:e||"line",zoom:{enabled:!1},width:"100%",toolbar:{show:this.chartOptions.toolbar}},fill:{type:"solid"},yaxis:{labels:{show:!1},show:!1,max:this.chartOptions.maxY,min:0},dataLabels:{enabled:!1},legend:{show:!1},grid:{show:!1},tooltip:{enabled:this.chartOptions.toolbar}}}},{key:"getChart",value:function(){return this.apexChartOptions}}]),t}()},MCdb:function(t,e,n){"use strict";n.r(e),n.d(e,"MonitorModule",(function(){return nt}));var r=n("ofXK"),a=n("lAuc"),i=n("Ut+n"),o=n("tyNb"),c=n("oaey"),u=n("kzyy"),l=n("FkO/"),s=n("ZtOR"),h=n("fXoL"),f=n("Zck+"),v=["audio"];function p(t,e){if(1&t&&h.Ob(0,"audio",2,3),2&t){var n=h.gc(2);h.mc("src",n.src,h.xc)}}function g(t,e){if(1&t&&(h.Sb(0,"div"),h.Cc(1,p,2,1,"audio",1),h.Rb()),2&t){var n=h.gc();h.zb(1),h.mc("ngIf",n.play)}}var m,d=((m=function(){function t(){_classCallCheck(this,t),this.play=!1,this.playRate=1}return _createClass(t,[{key:"ngOnChanges",value:function(t){var e=document.querySelector("audio");e&&t.playRate&&(e.playbackRate=t.playRate.currentValue)}},{key:"ngOnInit",value:function(){}}]),t}()).\u0275fac=function(t){return new(t||m)},m.\u0275cmp=h.Hb({type:m,selectors:[["app-audio"]],viewQuery:function(t,e){var n;1&t&&h.Jc(v,!0),2&t&&h.tc(n=h.fc())&&(e.audio=n.first)},inputs:{src:"src",play:"play",playRate:"playRate"},features:[h.xb],decls:1,vars:1,consts:[[4,"ngIf"],["id","audio","playbackRate","playRate","type","audio/mp3","loop","true","autoplay","true","preload","auto",3,"src",4,"ngIf"],["id","audio","playbackRate","playRate","type","audio/mp3","loop","true","autoplay","true","preload","auto",3,"src"],["audio",""]],template:function(t,e){1&t&&h.Cc(0,g,2,1,"div",0),2&t&&h.mc("ngIf",e.play)},directives:[r.l],styles:[""]}),m),b=n("CV0D"),C=["chart"];function y(t,e){if(1&t&&(h.Sb(0,"span",16),h.Ec(1),h.Rb()),2&t){var n=h.gc(2);h.zb(1),h.Gc(" ",n.animalSpecie.name," ")}}function S(t,e){1&t&&(h.Sb(0,"h4",17),h.Ob(1,"img",18),h.Ec(2,"Simulation stopped "),h.Rb())}function x(t,e){1&t&&(h.Sb(0,"h4",17),h.Ob(1,"img",19),h.Ec(2,"Simulation paused"),h.Rb())}function O(t,e){1&t&&(h.Sb(0,"h4",17),h.Ob(1,"img",20),h.Ec(2," \xa0Alarms off"),h.Rb())}function k(t,e){if(1&t){var n=h.Tb();h.Sb(0,"button",21),h.ec("click",(function(){return h.vc(n),h.gc(2).openFullscreen()})),h.Ob(1,"img",22),h.Ec(2," FullScreen"),h.Rb()}}function I(t,e){if(1&t){var n=h.Tb();h.Sb(0,"button",21),h.ec("click",(function(){return h.vc(n),h.gc(2).closeFullscreen()})),h.Ob(1,"img",22),h.Ec(2," Exit FullScreen"),h.Rb()}}function R(t,e){if(1&t&&h.Ob(0,"app-audio",25),2&t){var n=h.gc(3);h.mc("play",!0)("src","/assets/sounds/monitor.mp3")("playRate",n.calculatePlayRate())}}function w(t,e){if(1&t&&h.Ec(0),2&t){var n=h.gc().$implicit;h.Gc(" ",n.curveConfiguration.label.toUpperCase()," ")}}function _(t,e){if(1&t&&h.Ob(0,"apx-chart",31,32),2&t){var n=h.gc().$implicit;h.mc("series",n.chart.series)("stroke",n.chart.stroke)("xaxis",n.chart.xaxis)("yaxis",n.chart.yaxis)("markers",n.chart.markers)("dataLabels",n.chart.dataLabels)("chart",n.chart.chart)("grid",n.chart.grid)("tooltip",n.chart.tooltip)("autoUpdateSeries",!0)("legend",n.chart.legend)("fill",n.chart.fill)}}var M=function(t,e){return{"curve-label curve-label-left":t,"no-curves-label":e}},P=function(t,e){return{curves:t,"no-curves":e}};function T(t,e){if(1&t&&(h.Sb(0,"div",23),h.Sb(1,"div",28),h.Sb(2,"p",29),h.Cc(3,w,1,1,"ng-template",10),h.Rb(),h.Rb(),h.Sb(4,"div",30),h.Cc(5,_,2,12,"ng-template",10),h.Rb(),h.Rb()),2&t){var n=e.$implicit;h.zb(1),h.mc("ngClass",h.rc(4,M,n.chart&&n.chart.series,!n.chart||!n.chart.series)),h.zb(2),h.mc("ngIf",n.chart&&n.chart.series),h.zb(1),h.mc("ngClass",h.rc(7,P,n.chart&&n.chart.series,!n.chart||!n.chart.series)),h.zb(1),h.mc("ngIf",n.chart&&n.chart.series)}}function A(t,e){if(1&t&&(h.Sb(0,"p",41),h.Ec(1),h.Rb()),2&t){var n=h.gc(2).$implicit,r=h.gc(3);h.Bc("color",r.getColor(n)),h.zb(1),h.Gc(" ",r.getSourceRateValue(n)," ")}}function z(t,e){if(1&t&&(h.Sb(0,"p",41),h.Ec(1," -- "),h.Rb()),2&t){var n=h.gc(2).$implicit,r=h.gc(3);h.Bc("color",r.getColor(n))}}function E(t,e){if(1&t&&h.Ec(0),2&t){var n=h.gc(4).index,r=h.gc(3);h.Gc(" ",r.getMinValue(n)," ")}}function V(t,e){1&t&&h.Ec(0," -- ")}function D(t,e){if(1&t&&(h.Ec(0),h.Cc(1,E,1,1,"ng-template",10),h.Cc(2,V,1,0,"ng-template",10)),2&t){var n=h.gc(3).index,r=h.gc(3);h.Gc(" ",r.getMaxValue(n)," / "),h.zb(1),h.mc("ngIf",r.getMinValue(n)),h.zb(1),h.mc("ngIf",!r.getMinValue(n))}}function U(t,e){1&t&&h.Ec(0," -- / -- ")}function B(t,e){1&t&&h.Ec(0," -- ")}function F(t,e){if(1&t&&h.Ec(0),2&t){var n=h.gc(3).index,r=h.gc(3);h.Gc(" ",r.getMeanValue(n)," ")}}function L(t,e){if(1&t&&(h.Sb(0,"p",42),h.Cc(1,D,3,3,"ng-template",10),h.Cc(2,U,1,0,"ng-template",10),h.Ob(3,"br"),h.Cc(4,B,1,0,"ng-template",10),h.Cc(5,F,1,1,"ng-template",10),h.Rb()),2&t){var n=h.gc(2),r=n.$implicit,a=n.index,i=h.gc(3);h.Bc("color",i.getColor(r)),h.zb(1),h.mc("ngIf",i.getMaxValue(a)&&"stop"!==(null==i.currentState?null:i.currentState.action)),h.zb(1),h.mc("ngIf",!i.getMaxValue(a)||"stop"==(null==i.currentState?null:i.currentState.action)),h.zb(2),h.mc("ngIf",!i.getMeanValue(a)||"stop"==(null==i.currentState?null:i.currentState.action)),h.zb(1),h.mc("ngIf",i.getMeanValue(a)&&"stop"!==(null==i.currentState?null:i.currentState.action))}}var H=function(t){return{"alert-enabled":t}};function j(t,e){if(1&t&&(h.Sb(0,"div",35),h.Sb(1,"div",23),h.Ob(2,"div",36),h.Sb(3,"div",37),h.Cc(4,A,2,3,"p",38),h.Cc(5,z,2,2,"p",38),h.Cc(6,L,6,6,"p",39),h.Rb(),h.Sb(7,"div",40),h.Sb(8,"p"),h.Ec(9),h.Rb(),h.Sb(10,"p"),h.Ec(11),h.Rb(),h.Rb(),h.Rb(),h.Rb()),2&t){var n=h.gc(),r=n.index,a=n.$implicit,i=h.gc(3);h.mc("ngClass",h.qc(10,H,i.getAlerts()[r])),h.zb(4),h.mc("ngIf",!i.showMinAndMax(a)&&"stop"!==(null==i.currentState?null:i.currentState.action)),h.zb(1),h.mc("ngIf",!i.showMinAndMax(a)&&"stop"==(null==i.currentState?null:i.currentState.action)),h.zb(1),h.mc("ngIf",i.showMinAndMax(a)),h.zb(2),h.Bc("color",i.getColor(a)),h.zb(1),h.Gc(" ",null==a.curveConfiguration?null:a.curveConfiguration.label,""),h.zb(1),h.Bc("color",i.getColor(a)),h.zb(1),h.Gc(" ",null==a.curveConfiguration?null:a.curveConfiguration.unit,"")}}function G(t,e){if(1&t&&(h.Sb(0,"div",43),h.Sb(1,"p",29),h.Ec(2),h.Rb(),h.Rb()),2&t){var n=h.gc(),r=n.index,a=n.$implicit,i=h.gc(3);h.mc("ngClass",h.qc(4,H,i.getAlerts()[r])),h.zb(1),h.Bc("color",i.getColor(a)),h.zb(1),h.Gc(" ",null==a.curveConfiguration?null:a.curveConfiguration.label," ")}}function N(t,e){if(1&t&&(h.Sb(0,"div",23),h.Cc(1,j,12,12,"div",33),h.Cc(2,G,3,6,"div",34),h.Rb()),2&t){var n=e.$implicit;h.zb(1),h.mc("ngIf","CAR"!=(null==n.curveConfiguration?null:n.curveConfiguration.label.toUpperCase())&&"RESP"!=(null==n.curveConfiguration?null:n.curveConfiguration.label.toUpperCase())),h.zb(1),h.mc("ngIf","CAR"!=(null==n.curveConfiguration?null:n.curveConfiguration.label.toUpperCase())&&"RESP"!=(null==n.curveConfiguration?null:n.curveConfiguration.label.toUpperCase()))}}function $(t,e){if(1&t&&(h.Sb(0,"div",23),h.Cc(1,R,1,3,"app-audio",24),h.Ob(2,"app-audio",25),h.Sb(3,"div",4),h.Sb(4,"div",23),h.Sb(5,"div",26),h.Cc(6,T,6,10,"div",27),h.Rb(),h.Sb(7,"div",11),h.Cc(8,N,3,2,"div",27),h.Rb(),h.Rb(),h.Rb(),h.Rb()),2&t){var n=h.gc(2);h.zb(1),h.mc("ngIf","stop"!==(null==n.currentState?null:n.currentState.action)),h.zb(1),h.mc("play",n.enableSoundAlarm)("src","/assets/sounds/alarmLimit.mp3")("playRate",1),h.zb(4),h.mc("ngForOf",n.curvesAndParams),h.zb(2),h.mc("ngForOf",n.curvesAndParams)}}function X(t,e){if(1&t&&(h.Sb(0,"div",4),h.Sb(1,"div",5),h.Sb(2,"div",6),h.Sb(3,"p",7),h.Ec(4),h.hc(5,"date"),h.Cc(6,y,2,1,"span",8),h.Rb(),h.Rb(),h.Sb(7,"div",9),h.Cc(8,S,3,0,"ng-template",10),h.Cc(9,x,3,0,"ng-template",10),h.Cc(10,O,3,0,"ng-template",10),h.Rb(),h.Sb(11,"div",11),h.Sb(12,"div",5),h.Ob(13,"div",12),h.Sb(14,"div",13),h.Cc(15,k,3,0,"button",14),h.Cc(16,I,3,0,"button",14),h.Rb(),h.Rb(),h.Rb(),h.Rb(),h.Cc(17,$,9,6,"div",15),h.Rb()),2&t){var n=h.gc(),r=h.uc(4);h.zb(4),h.Gc(" ",h.jc(5,9,n.today,"medium")," "),h.zb(2),h.mc("ngIf",n.animalSpecie),h.zb(2),h.mc("ngIf","stop"===(null==n.currentState?null:n.currentState.action)),h.zb(1),h.mc("ngIf","pause"===(null==n.currentState?null:n.currentState.action)),h.zb(1),h.mc("ngIf",n.currentState.muteAlarms&&"stop"!==(null==n.currentState?null:n.currentState.action)),h.zb(5),h.mc("ngIf",!n.isFullScren()),h.zb(1),h.mc("ngIf",n.isFullScren()),h.zb(1),h.mc("ngIf",n.existDataset())("ngIfElse",r)}}function Y(t,e){1&t&&(h.Sb(0,"div",44),h.Ob(1,"div",45),h.Sb(2,"div",46),h.Sb(3,"h3",17),h.Ec(4,"Waiting for simulation"),h.Rb(),h.Rb(),h.Rb())}function q(t,e){1&t&&(h.Sb(0,"div",44),h.Sb(1,"p"),h.Ec(2,"NO SIMULATION "),h.Rb(),h.Rb())}var J,Z,K,W=[{path:"",component:(J=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this)).monitorService=t,r.today=new Date,r.maxSize=51,r.currentIndex=0,r.curvesAndParams=[],r.curvesHelper=new s.a,r.enableAlerts=[],r.monitorConfiguration=new u.a,r.trackByFn=function(t,e){return e.curveConfiguration.id_pp},r.enableSoundAlarm=!1,r.tooltipPause={enabled:!0},r.noDataset=!1,r.initVariables(),r}return _createClass(n,[{key:"ngOnInit",value:function(){this.checkLocalStorage()}},{key:"ngOnDestroy",value:function(){clearInterval(this.simulationTimer)}},{key:"openFullscreen",value:function(){document.fullscreenElement||document.documentElement.requestFullscreen()}},{key:"closeFullscreen",value:function(){document.fullscreenElement&&document.exitFullscreen()}},{key:"isFullScren",value:function(){return null!=document.fullscreenElement}},{key:"checkLocalStorage",value:function(){var t=this;this.monitorService.getInfo().subscribe((function(e){e?(t.updateParameterInfo(),t.updateCurves(e)):t.initVariables()}),(function(t){console.log(t)}),(function(){console.log("Simulation finished!")}))}},{key:"updateParameterInfo",value:function(){this.parameterInfo=JSON.parse(localStorage.getItem("parameterState"))}},{key:"initVariables",value:function(){this.currentState=null,this.animalSpecie=null,this.enableAlerts=[],this.firstSimulationHeart=!0,this.firstSimulationBreath=!0,this.curvesAndParams=[],this.chartsOptions=[],this.currentIndex=0,this.maxSize=51,this.breathTimer=0,this.heartTimer=0,clearInterval(this.simulationTimer)}},{key:"updateCurves",value:function(t){this.noDataset=!1,this.currentState=t,this.animalSpecie=t.animalSpecie,this.initCharts(t.newScenario),clearInterval(this.simulationTimer),"pause"!=t.action&&this.simulateCurves(),this.noDataset||this.showToolbar()}},{key:"initCharts",value:function(){var t,e=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=0==(null===(t=this.chartsOptions)||void 0===t?void 0:t.length),a=0;n&&(this.chartsOptions=[],this.firstSimulationHeart=!0,this.firstSimulationBreath=!0,this.chartsOptions=[],this.breathTimer=0,this.heartTimer=0,clearInterval(this.simulationTimer)),this.currentState.curves.forEach((function(t,i){var o=e.enableAlerts[i];if(0==t.curveValues.length&&(a+=1),(r||n)&&e.createDynamicChart(t),null==o){var c=e.enableAlert(t.curveConfiguration)&&"stop"!==e.currentState.action;e.enableAlerts.push(c)}else e.enableAlerts[i]=e.enableAlert(t.curveConfiguration)&&"stop"!==e.currentState.action;e.enableSoundAlarm=e.enableAlerts.includes(!0)&&!e.currentState.muteAlarms&&"stop"!==e.currentState.action})),a==this.currentState.curves.length&&(this.noDataset=!0,this.initVariables())}},{key:"createDynamicChart",value:function(t){if(t.curveValues.length>0){var e=this.curvesHelper.getMaxY(t.curveValues)+1,n=this.curvesHelper.getMinY(t.curveValues)-1,r=new l.a({colorLine:t.curveConfiguration.colorLine,height:143,minX:0,maxX:this.monitorConfiguration.getMonitorConfiguration().maxSamples,minY:n,maxY:"CO2"==t.curveConfiguration.label.toUpperCase()||"ETCO2"==t.curveConfiguration.label.toUpperCase()?2*e:e,toolbar:!1}),a=null;"ETCO2"!=t.curveConfiguration.label.toUpperCase()&&"CO2"!=t.curveConfiguration.label.toUpperCase()||"stop"===this.currentState.action||(a="area"),r.setChart([],a),this.chartsOptions.push(r.getChart()),this.curvesAndParams.push({chart:r.getChart(),curveConfiguration:t.curveConfiguration})}else this.curvesAndParams.push({curveConfiguration:t.curveConfiguration})}},{key:"simulateCurves",value:function(){var t=this;this.currentState&&!this.noDataset&&(this.simulationTimer=setInterval((function(){t.updateHeartTimer(),t.updateBreathTimer(),t.updateCurrentIndex(),t.currentState.curves.forEach((function(e,n){e.curveValues.length>0&&t.simulateCurve(e,n)})),t.updateCharts(),t.heartTimer+=t.monitorConfiguration.getMonitorConfiguration().freqHeart/1e3,t.breathTimer+=t.monitorConfiguration.getMonitorConfiguration().freqBreath/1e3,t.currentIndex+=1,t.today=new Date}),this.monitorConfiguration.getMonitorConfiguration().clockTimer))}},{key:"simulateCurve",value:function(t,e){var n,r,a,i;if((this.firstSimulationHeart&&!this.isBreathCurve(e)||this.firstSimulationBreath&&this.isBreathCurve(e))&&t.curveValues.length>0)this.updateDataset(e,t.curveValues);else if(t.curveValues.length>0&&(null===(r=null===(n=this.curvesAndParams[e])||void 0===n?void 0:n.chart)||void 0===r?void 0:r.series)){var o=null===(i=null===(a=this.curvesAndParams[e])||void 0===a?void 0:a.chart)||void 0===i?void 0:i.series.slice();this.updateDatasetSimulation(o,e)}}},{key:"updateCurrentIndex",value:function(){this.currentIndex>=this.maxSize&&(this.currentIndex=0)}},{key:"getAlerts",value:function(){return this.enableAlerts}},{key:"updateDataset",value:function(t,e){var n,r,a,i=null===(a=null===(r=null===(n=this.curvesAndParams[t])||void 0===n?void 0:n.chart)||void 0===r?void 0:r.series)||void 0===a?void 0:a.slice();if(i){var o=this.isBreathCurve(t);if("stop"==this.currentState.action){var c=this.charts.toArray()[t];i[0].data.push([o?this.breathTimer:this.heartTimer,c.yaxis.max/2])}else i[0].data.push([o?this.breathTimer:this.heartTimer,e[this.currentIndex][1]])}}},{key:"updateDatasetSimulation",value:function(t,e){var n=t[0].data,r=this.isBreathCurve(e),a=t[1].data;if("stop"==this.currentState.action){var i=this.charts.toArray()[e];a.push([r?this.breathTimer:this.heartTimer,(i.yaxis.max+i.yaxis.min)/2])}else a.push([r?this.breathTimer:this.heartTimer,this.currentState.curves[e].curveValues[this.currentIndex][1]]);this.deleteOldPoints(n,r?this.breathTimer:this.heartTimer),t[0].data=n,t[1].data=a}},{key:"isBreathCurve",value:function(t){var e,n,r;return"RESP"==(null===(r=null===(n=null===(e=this.currentState.curves[t].curveConfiguration)||void 0===e?void 0:e.source)||void 0===n?void 0:n.label)||void 0===r?void 0:r.toUpperCase())}},{key:"updateHeartTimer",value:function(){this.firstSimulationHeart?this.heartTimer>=this.monitorConfiguration.getMonitorConfiguration().maxSamples&&(this.heartTimer=0,this.firstSimulationHeart=!1,this.createSimulationDataset()):this.heartTimer>=this.monitorConfiguration.getMonitorConfiguration().maxSamples&&(this.heartTimer=0,this.swapCurves())}},{key:"updateBreathTimer",value:function(){this.firstSimulationBreath?this.breathTimer>=this.monitorConfiguration.getMonitorConfiguration().maxSamples&&(this.breathTimer=0,this.firstSimulationBreath=!1,this.createSimulationDataset(!0)):this.breathTimer>=this.monitorConfiguration.getMonitorConfiguration().maxSamples&&(this.breathTimer=0,this.swapCurves(!0))}},{key:"updateCharts",value:function(){this.charts.toArray().forEach((function(t){t.updateSeries(t.series,!1)}))}},{key:"updateChart",value:function(t,e){!(arguments.length>2&&void 0!==arguments[2])||arguments[2];var n=this.charts.toArray()[e];n&&n.updateSeries(t,!1)}},{key:"getColor",value:function(t){var e;return(null==t?void 0:t.curveConfiguration)&&(null===(e=t.curveConfiguration)||void 0===e?void 0:e.colorLine)?t.curveConfiguration.colorLine:null}},{key:"getSourceRateValue",value:function(t){if((null==t?void 0:t.curveConfiguration)&&t.curveConfiguration.source)switch(t.curveConfiguration.source.label.toUpperCase()){case"CAR":return this.parameterInfo.heartRate;case"RESP":return this.parameterInfo.breathRate;case"SPO2":return this.parameterInfo.spO2}else switch(t.curveConfiguration.label.toUpperCase()){case"TEMP":return this.parameterInfo.temperature;default:return t.curveConfiguration.refValue}return-1}},{key:"getParameterInfo",value:function(){return this.parameterInfo}},{key:"enableAlert",value:function(t){var e,n,r;return"CAR"===(null===(e=t.source)||void 0===e?void 0:e.label.toUpperCase())&&(t.alert_high<=this.parameterInfo.heartRate||t.alert_low>=this.parameterInfo.heartRate)||"RESP"===(null===(n=t.source)||void 0===n?void 0:n.label.toUpperCase())&&(t.alert_high<=this.parameterInfo.breathRate||t.alert_low>=this.parameterInfo.breathRate)||"SPO2"===(null===(r=t.source)||void 0===r?void 0:r.label.toUpperCase())&&(t.alert_high<=this.parameterInfo.spO2||t.alert_low>=this.parameterInfo.spO2)}},{key:"deleteOldPoints",value:function(t,e){for(var n=0;n<t.length&&t[n][0]<=e;)t.splice(n,1),n++}},{key:"swapCurves",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=0;e<this.currentState.curves.length;e++)if(this.currentState.curves[e].curveValues.length>0&&this.hasToChangeDataset(e,t)){var n=this.chartsOptions[e].series;n[0].data=n[1].data,n[1].data=[],this.updateChart(n,e,!1)}}},{key:"createSimulationDataset",value:function(){for(var t,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=0;n<this.currentState.curves.length;n++)if(this.hasToChangeDataset(n,e)){var r=null===(t=this.chartsOptions[n])||void 0===t?void 0:t.series;r&&r.push({data:[],color:r[0].color})}}},{key:"hasToChangeDataset",value:function(t,e){var n,r,a,i,o,c;return e&&"RESP"==(null===(a=null===(r=null===(n=this.currentState.curves[t].curveConfiguration)||void 0===n?void 0:n.source)||void 0===r?void 0:r.label)||void 0===a?void 0:a.toUpperCase())||!e&&"RESP"!=(null===(c=null===(o=null===(i=this.currentState.curves[t].curveConfiguration)||void 0===i?void 0:i.source)||void 0===o?void 0:o.label)||void 0===c?void 0:c.toUpperCase())}},{key:"showToolbar",value:function(){for(var t,e=this.charts.toArray(),n=0;n<e.length;n++){var r=e[n];if(null===(t=this.currentState.curves[n])||void 0===t?void 0:t.curveConfiguration){var a=this.currentState.curves[n].curveConfiguration,i=Object(l.b)("pause"==this.currentState.action,r.xaxis.max,r.xaxis.min,"IBP"==a.label.toUpperCase()?250:r.yaxis.max,r.yaxis.min,"stop"===this.currentState.action||"ETCO2"!=a.label.toUpperCase()&&"CO2"!=a.label.toUpperCase()?r.chart.type:"area");"stop"!==this.currentState.action&&e[n].updateOptions(i)}}}},{key:"calculatePlayRate",value:function(){return this.parameterInfo.heartRate/1e3}},{key:"existDataset",value:function(){return!this.noDataset}},{key:"showMinAndMax",value:function(t){return"CO2"===t.curveConfiguration.label.toUpperCase()||"IBP"===t.curveConfiguration.label.toUpperCase()||"NIBP"===t.curveConfiguration.label.toUpperCase()}},{key:"getMinValue",value:function(t){var e=this.currentState.curves[t];return e&&e.curveValues&&e.curveValues.length>0?Math.round(e.curveValues[0][1]):null}},{key:"getMaxValue",value:function(t){var e=this.currentState.curves[t];return e&&e.curveValues&&e.curveValues.length>0?Math.round(this.curvesHelper.getMaxY(e.curveValues)):null}},{key:"getMeanValue",value:function(t){var e=this.getMaxValue(t),n=this.getMinValue(t);return e?Math.round((2*n+e)/3):null}}]),n}(c.a),J.\u0275fac=function(t){return new(t||J)(h.Nb(f.a))},J.\u0275cmp=h.Hb({type:J,selectors:[["app-monitor"]],viewQuery:function(t,e){var n;1&t&&h.Jc(C,!0),2&t&&h.tc(n=h.fc())&&(e.charts=n)},features:[h.wb],decls:5,vars:2,consts:[["class","container-fluid",4,"ngIf","ngIfElse"],["class","mt-4 no-simulation"],["noSimulation",""],["noDataset",""],[1,"container-fluid"],[1,"row","justify-content-between"],[1,"col-4"],[1,"text-left"],["class","text-animal-specie",4,"ngIf"],[1,"col-4","alarms-off"],[3,"ngIf"],[1,"col-3"],[1,"col-5"],[1,"col-7"],["class","btn btn-link",3,"click",4,"ngIf"],["class","row",4,"ngIf","ngIfElse"],[1,"text-animal-specie"],[1,"text-center"],["src","https://img.icons8.com/fluency/24/000000/stop.png",1,"img-status"],["src","https://img.icons8.com/fluency/24/000000/pause.png","title","Freeze simulation",1,"img-status"],["src","https://img.icons8.com/external-kiranshastry-lineal-color-kiranshastry/30/000000/external-mute-multimedia-kiranshastry-lineal-color-kiranshastry.png"],[1,"btn","btn-link",3,"click"],["src","https://img.icons8.com/office/20/000000/fit-to-width.png"],[1,"row"],[3,"play","src","playRate",4,"ngIf"],[3,"play","src","playRate"],[1,"container-fluid","col-9"],["class","row",4,"ngFor","ngForOf"],[1,"col-xs-1","curve-label-left-col",3,"ngClass"],[1,"text-label"],[1,"col-11",3,"ngClass"],[3,"series","stroke","xaxis","yaxis","markers","dataLabels","chart","grid","tooltip","autoUpdateSeries","legend","fill"],["chart",""],["class","col-11 curve-configuration",3,"ngClass",4,"ngIf"],["class","col-xs-1 curve-label",3,"ngClass",4,"ngIf"],[1,"col-11","curve-configuration",3,"ngClass"],[1,"col-2"],[1,"col-6"],["class","text-rate",3,"color",4,"ngIf"],["class","min-max-value",3,"color",4,"ngIf"],[1,"col-4","parameter-box-var"],[1,"text-rate"],[1,"min-max-value"],[1,"col-xs-1","curve-label",3,"ngClass"],[1,"container","row","no-simulation"],["role","status",1,"spinner-border","text-danger"],[1,"ml-4"]],template:function(t,e){if(1&t&&(h.Cc(0,X,18,12,"div",0),h.Cc(1,Y,5,0,"ng-template",1,2,h.Dc),h.Cc(3,q,3,0,"ng-template",1,3,h.Dc)),2&t){var n=h.uc(2);h.mc("ngIf",(null==e.currentState?null:e.currentState.curves.length)>0)("ngIfElse",n)}},directives:[r.l,d,r.k,r.j,b.a],pipes:[r.d],styles:[".text-animal-specie[_ngcontent-%COMP%]{margin-left:20px}.no-simulation[_ngcontent-%COMP%]{height:100%}.icon-pause[_ngcontent-%COMP%], .icon-stopped[_ngcontent-%COMP%]{color:#fff;margin-right:2%}.curve-configuration[_ngcontent-%COMP%]{min-width:250px;-webkit-animation:none;animation:none;margin-left:0}.curve-configuration[_ngcontent-%COMP%], .curve-label[_ngcontent-%COMP%]{border:2px solid #fff;border-radius:10px;max-height:14vh}.curve-label[_ngcontent-%COMP%]{max-width:20px}.text-label[_ngcontent-%COMP%]{writing-mode:vertical-rl;padding:10px 0 25px;font-size:16px;margin-left:-4px}.no-curves[_ngcontent-%COMP%], .no-curves-label[_ngcontent-%COMP%]{display:hidden;max-height:0}.no-curves-label[_ngcontent-%COMP%]{padding-left:0;margin-left:0}.curve-label-left[_ngcontent-%COMP%]{border:none!important;max-width:15px;padding-top:5%;max-height:50px;padding-left:.5%}.label-left[_ngcontent-%COMP%]{letter-spacing:4px}.text-rate[_ngcontent-%COMP%]{font-size:3rem}.container-configuration[_ngcontent-%COMP%]{width:15%}.parameter-box-var[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{line-height:.1em}.parameter-box-var[_ngcontent-%COMP%]{padding-top:.7rem}.alert-enabled[_ngcontent-%COMP%]{-webkit-animation:pulse 3s infinite;animation:pulse 3s infinite;font-weight:700}@-webkit-keyframes pulse{0%{background-color:#8b2e3e}to{background-color:#d81812}}@keyframes pulse{0%{background-color:#8b2e3e}to{background-color:#d81812}}h3[_ngcontent-%COMP%], h4[_ngcontent-%COMP%], p[_ngcontent-%COMP%]{color:#fff;-webkit-user-select:none;-moz-user-select:none;user-select:none}.img-status[_ngcontent-%COMP%]{margin-right:2%}.curves[_ngcontent-%COMP%]{width:100%;min-height:20vh;max-height:20vh;margin-right:0}.min-max-value[_ngcontent-%COMP%]{font-size:1.7rem}@media (display-mode:fullscreen){.curves[_ngcontent-%COMP%]{max-height:20vh;margin:0;padding:0}.no-curves[_ngcontent-%COMP%], .no-curves-label[_ngcontent-%COMP%]{display:hidden;max-height:0}.curve-label[_ngcontent-%COMP%]{min-height:13vh}.curve-label-left[_ngcontent-%COMP%]{min-height:20vh}.curve-configuration[_ngcontent-%COMP%]{min-height:14vh}}@media (max-width:1920px){.curves[_ngcontent-%COMP%]{min-width:910px;min-height:18vh;max-height:18vh;margin-right:0}}.btn-link[_ngcontent-%COMP%]{padding:0;margin:0}"]}),J)}],Q=((Z=function t(){_classCallCheck(this,t)}).\u0275mod=h.Lb({type:Z}),Z.\u0275inj=h.Kb({factory:function(t){return new(t||Z)},providers:[i.a],imports:[[o.d.forChild(W)],o.d]}),Z),tt=n("3Pt+"),et=n("PCNd"),nt=((K=function t(){_classCallCheck(this,t)}).\u0275mod=h.Lb({type:K}),K.\u0275inj=h.Kb({factory:function(t){return new(t||K)},providers:[i.a,f.a],imports:[[r.b,a.SimulationModule,Q,tt.i,et.a,tt.t,b.b]]}),K)},"Zck+":function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n("XNiG"),a=n("fXoL"),i=function(){var t=function(){function t(){var e=this;_classCallCheck(this,t),this.values=new r.a,setInterval((function(){var t=JSON.parse(localStorage.getItem("simulationState"));e.currentState&&!e.isDiff(t)||(e.currentState=t,e.values.next(e.currentState))}),1e3)}return _createClass(t,[{key:"getInfo",value:function(){return this.values.asObservable()}},{key:"isDiff",value:function(t){return!t&&null!=this.currentState||t.state!==this.currentState.state||t.action!==this.currentState.action||t.muteAlarms!==this.currentState.muteAlarms}}]),t}();return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=a.Jb({token:t,factory:t.\u0275fac}),t}()},ZtOR:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"editX",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return e||(e=Math.floor(10*Math.random())),t.forEach((function(t){t[0]&&(t[0]=t[0]+e)})),t}},{key:"editY",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return e||(e=Math.floor(10*Math.random())),t.forEach((function(t){t[1]&&(t[1]=t[1]+e)})),t}},{key:"getMaxY",value:function(t){var e,n=t[0][1],r=_createForOfIteratorHelper(t);try{for(r.s();!(e=r.n()).done;){var a=e.value;a[1]>n&&(n=a[1])}}catch(i){r.e(i)}finally{r.f()}return n}},{key:"getMinY",value:function(t){var e,n=t[0][1],r=_createForOfIteratorHelper(t);try{for(r.s();!(e=r.n()).done;){var a=e.value;a[1]<n&&(n=a[1])}}catch(i){r.e(i)}finally{r.f()}return n}},{key:"linealInterpolation",value:function(t,e,n,r,a){return(a-r)/(e-t)*(n-t)+r}},{key:"lagrangeInterpolation",value:function(t,e){for(var n=0,r=0;r<t.length;r++)n+=t[r][1]*this.lagrangeFunction(t,e,r);return n}},{key:"lagrangeFunction",value:function(t,e,n){for(var r=1,a=1,i=0;i<t.length-1;i++)n!=i&&(r*=e-t[i][0],a*=t[n][0]-t[i][0]);return r/a}},{key:"getClosestIndex",value:function(t,e){for(var n=0;n<t.length;n++)if(t[n][0]>e)return 0!=n?{lessValue:t[n-1],greaterValue:t[n]}:{lessValue:t[n],greaterValue:t[n+1]};return{lessValue:t[t.length-1],greaterValue:t[t.length-2]}}},{key:"calculateRate",value:function(t,e){var n=60/t;return n?e/1e3*n:-1}}]),t}()},kzyy:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r=function(){function t(){_classCallCheck(this,t),this.monitorConfiguration={clockTimer:10,freqHeart:20,freqBreath:15,maxSamples:5};var e=JSON.parse(localStorage.getItem("monitor"));e&&(this.monitorConfiguration=e)}return _createClass(t,[{key:"setMonitorConfiguration",value:function(t){this.monitorConfiguration=t}},{key:"getMonitorConfiguration",value:function(){return this.monitorConfiguration}}]),t}()}}]);